{% extends 'base.html' %}

{% block title %}Manage {{ category['name'] }}{% endblock %}

{% block header %}
    <h1>Manage Questions for {{ category['name'] }}</h1>
{% endblock %}

{% block content %}

    <section>
        <h2>Existing Questions</h2>
        {% if questions %}
            <ul class="question-list">
                {% for question in questions %}
                    <li>
                        <strong>{{ question['question_text'] }}</strong>
                        <ul class="answer-list">
                            {% for answer in question['answers'] %}
                                <li>
                                    {{ answer['answer_text'] }}
                                    {% if answer['is_correct'] %}
                                        <span class="correct-answer">(Correct Answer)</span>
                                    {% endif %}
                                </li>
                            {% endfor %}
                        </ul>
                        <div class="question-actions">
                            <a href="{{ url_for('category.edit_question', question_id=question['id']) }}" class="edit-link">Edit</a>

                            <form action="{{ url_for('category.delete_question', category_id=category['id'], question_id=question['id']) }}" method="post" style="display:inline;">
                                <button type="submit" class="delete-link">Delete</button>
                            </form>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No questions available for this category yet.</p>
        {% endif %}
    </section>

    <section>
        <h2>Add New Question</h2>
        <form method="post" action="{{ url_for('category.add_question', category_id=category['id']) }}" class="add-question-form">
            <div class="form-group">
                <label for="question">Question:</label>
                <input type="text" name="question" id="question" required>
            </div>

            <div class="form-group">
                <label>Answer Choices</label>
                {% for i in range(1, 5) %}
                    <input type="text" name="answer{{ i }}" placeholder="Answer {{ i }}" required>
                {% endfor %}
            </div>

            <div class="form-group">
                <label for="correct_answer">Select Correct Answer:</label>
                <select name="correct_answer" id="correct_answer" required>
                    {% for i in range(1, 5) %}
                        <option value="{{ i }}">Answer {{ i }}</option>
                    {% endfor %}
                </select>
            </div>

            <button type="submit" class="btn">Add Question</button>
        </form>
    </section>

    <a href="{{ url_for('category.view') }}" class="back-link">Back to Categories</a>

{% endblock %}
